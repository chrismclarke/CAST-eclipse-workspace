package pairBlock;import dataView.*;import distn.*;import coreSummaries.*;public class TwoGroupCIVariable extends IntervalSummaryVariable {	private NumVariable yVar;	private CatVariable groupVar;	private int decimals;	private double confLevel;		public TwoGroupCIVariable(String theName, DataSet data, String yKey, String groupKey,																														double confLevel, int decimals) {		super(theName);		yVar = (NumVariable)data.getVariable(yKey);		groupVar = (CatVariable)data.getVariable(groupKey);		this.decimals = decimals;		this.confLevel = confLevel;	}		protected IntervalValue evaluateSummary(DataSet sourceData) {		int n[] = new int[2];		double sy[] = new double[2];		double syy[] = new double[2];				ValueEnumeration ye = yVar.values();		ValueEnumeration ge = groupVar.values();		while (ye.hasMoreValues() && ge.hasMoreValues()) {			double y = ye.nextDouble();			int g = groupVar.labelIndex(ge.nextValue());			n[g] ++;			sy[g] += y;			syy[g] += y * y;		}				double diffMean = sy[1] / n[1] - sy[0] / n[0];				double var0 = (syy[0] - sy[0] * sy[0] / n[0]) / (n[0] - 1);		double var1 = (syy[1] - sy[1] * sy[1] / n[1]) / (n[1] - 1);				double se = Math.sqrt(var0 / n[0] + var1 / n[1]);				int df = Math.min(n[0], n[1]) - 1;		double tValue = -TTable.quantile(0.5 * (1.0 - confLevel), df);				return new IntervalValue(diffMean, se, tValue, decimals);	}}